<% |
Optional[Hash] $metrics = {},
String $textfile_directory = "",
| -%>
#!/bin/bash
metrics=()
<% $metrics.each |$key, $value| { -%>
metrics+=(<%= $key %>)
<% } -%>
for file in <%= $textfile_directory -%>/*.prom*; do
  name=$(basename "$file")
  if [[ -f "$file" ]]; then
    for element in "${metrics[@]}"; do
        if [[ $name == "${element}.prom"* ]]; then
            continue 2
        fi
    done
    rm "$file"
  fi
done
