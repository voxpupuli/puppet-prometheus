<% |
Optional[Hash] $metrics = {},
String $metrics_directory = "",
| -%>
metrics=()
<% $metrics.each |$key, $value| { -%>
metrics+=(<%= $key %>)
<% } -%>
for file in <%= $metrics_directory -%>/*.prom*; do
  name=$(basename "$file")
  if [[ -f "$file" ]]; then
    for element in "${metrics[@]}"; do
        if [[ $name == "${element}.prom"* ]]; then
            continue 2
        fi
    done
    rm "$file"
  fi
done
